

### 数仓命名 
层名-事业部-业务线-房东开始用户-主题域-自定义名字-更新周期


### 维度建模流程
1. 首先是以相对应的业务过程确定事实表的类型是什么
2. 然后开始精确事实表每一个字段的业务含义是什么，选择用最细粒度的字段
3. 于是围绕这个业务过程的事件发散他的描述维度信息
4. 再到确定这个过程度量是什么
5. 将一些维度退化到事实表中
6. 再开始确定我们的命名规范，完成设计。
### 数仓建模流程
我们是自下而上的建模流程，针对客户的需求，需要什么我们做什么
1. 首先我们拿到PRD文档后会去开几个与业务部门的会议或者单独的聊天进行需求沟通，统一口径，梳理好业务逻辑，确定主题域
2. 然后我们就会开始画ER图去来明确业务的构造，确定相应的字段，明确原子指标，派生指标，衍生指标，建立中心事实表
3. 对指标进行扩散思维去拿到相应的维度，进行维度建模
4. 开始落地实表，注意一些命名规范
5. 最后进行数据校验的工作，等测试完成后续进行不断的优化操作。



###  数据量问题 业务特征 规模 用户规模  计算 (时长, 事件频次, 日志数据大小 ,用户数据)
木鸟 5000万用户  100-150万活跃度 
差不多10多秒产生一个数据 
一个人一次事件产生1.2kb
每个活跃用户平均产生70-80条数据 
每个人一天的事件大小85kb左右
每天200多G  
平均公司 按最大的来算就3.5M/s的数据
高峰期35M/s 
(只是暂时的 还需要更改)



### 数据服务总线   为什么开发这个服务
这个服务主要是是能给数仓提供了统计每个服务器日志的行数以及flume采集到的HDFS日志的行数,主要的功能有日志上报和日志条数查询

1. 日志的上报具体为通过请求服务接口来传递参数,将每天的日志条数,日志类型,日期,以及服务器名等等上报到服务端,然后将数据通过Mybatis框架存储到Mysql中,且会发送邮件来提示是否已经上传成功

2. 日志的查询功能具体就是调用服务端的接口的来从Mysql中查询日志行数和HDFS的的文件行数来供后续的去重脚本使用


### 你们事实表包含哪些维度和度量 
维度：地域商圈 客群分类 房源描述 住客点评
度量  
Occ客房入住率 
ADR已售客房平均房价 
RevPAR 可供出租客房的收入 
Revenue月收入
CTP 营业利润贡献
GSS 宾客满意程度指数
MPI 市场渗透指数 



### UDF的使用 
我们在做地理位置回补创建字典表的时候,将经纬度退化成geohash值就用到了UDF
还有个人信息用AES加密算法加密、脱敏等也用到了





### 增量脚本多还是全量脚本多 
据我所知一开始的什么字典表啊地域表规则表或者是那些几乎不会更变数据的表都是用的全量
而那些会更新得比较频繁的表,比如订单表啊,会员信息表我们就会每日增量的去导入,然后做成拉链表的形式放到dwd层