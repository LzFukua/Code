###1.项目背景和项目意义



###2.项目的基本框架



###3.用到的技术栈 
* 数据采集系统:Flume(采集行为日志) sqoop(采集业务数)
* 数据存储:Mysql,HDFS,HBASE
* 数据计算 Hive,Spark
* 资源调度系统:Yarn
* 快速查询:Presto
* 数据看台:SuperSet
* 任务调度:Dolphin
* 元数据管理:Atlas


###4.离线数仓项目 , 主要的核心工作有哪些




###5.离线数仓项目 , 意义





###6. 关于flume
>核心角色是agent,相当于一个传输通道,里面有三个组件
>sources 负责读取数据
>channel 缓存读取出来的数据
>sink  写出数据

>内置拦截器
>主机拦截器/静态拦截器

>内置sources
>tailDir/

>内置channel
>memory 和 file 

>内置 sink  
>HDFS

>自定义拦截器的开发步骤 , 完成需求
> 我所认为的拦截器就像一个交通指挥官,把不同种类的日志分发到不同的分析系统,其主要的点在更改flume的event的header的value值

>自定义首先得导入依赖,然后创建一个自定义的拦截器类去实现Interceptor接口,重写里面的四个方法
>1.初始化拦截器
>2.处理每条事件
>3.处理每批事件
>4.结束拦截器
>然后构建一个拦截器的构建器,因为自定义拦截器的类无法直接new，需要通过flume配置文件调用静态内部类，来间接地调用自定义的拦截器对象。
>打一个有依赖的包传入到flume的lib文件下,配置interceptor type 为包名就可以实现了

###7.你们工作时使用的是什么source  channel, 为什么使用他们  
平时我们工作上使用的source是TailDir,可以监控多个目录嘛,而且也有position机制能让我实时监控数据的变化
对于channel 我们使用的是File channel,因为他可以保证数据彻底的安全,且还可以加checkpoint机制加个副本,只是速度不是那么快而已

###8.flume的事务了解吗? 说一下flume的事务!  事务分类 , 事务的流程 ,事务效果 !

了解的,首先flume事务他的就是为了保证数据的可靠传递嘛,他分成了两个数据传递的事务处理,一个是put事务,一个是take事务,我们首先来说说put事务
1. put事务是source端向channel端去传递数据的时候触发的,source会采集数据封装为event,调用doput方法将这批event写到putlist临时缓存区,写满了就进行docommit去检查channel中是否有足够空间去装这批数据,如果可以,putlist就会清空这批数据到channel里,但如果channels容量不足,就进行rollback回滚的操作,清空putlist,然后返回异常给sources,重新采集一遍这批数据进来.

2. 而take事务就是sink端从channel端拉取数据的时候触发的,首先事务开始时调用doTake方法将channel里的event剪切到takeList中,同时也会拷贝一份放到HDFS的IO缓冲流中,当takeList满了之后就会触发doCommit方法,如果数据全部发送成功就会去调用IO流的flush方法将数据写道HDFS磁盘上,同时清空takelist的数据,但如果失败了,就会进行回滚操作,让takelist里的数据重新放入到channel.但这时候可能会导致数据重复,是因为当IO缓存区有一些数据已经传输成功了但回滚操作是把整个takelist的数据都回滚回去重新拉取.

而事务有三个比较重要的参数 一个是sources和sink端的batchSize 以及channel端的capacity 和transactionCapacity  capacity > transactionCapacity > batchSize


###9.什么是flume的failover机制!
在谈failover之前,得先说到级联的问题,级联是在实际生产中我们的日志服务器和HDFS集群之间是不能直接访问的
所以我们会设立中间层的agent去做通信来保证数据的安全.而failover就是上游agent会配置多个sink到不同agent中来实现高可用,避免一个agent宕机导致数据积压在上游.failover会设置了权重比去安排主从的agent传输通道,权重比大的为主节点,而当主节点宕机就开始启用备用节点的通道去传输,在此基础上还会设立退避时间去一段时间询问主节点有没有恢复,如果恢复了就继续让主节点传输.


###10.flume的内部5大组件!




###11.说说flume的优化!
