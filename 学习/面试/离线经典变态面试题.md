###  100万个数字的文件乱序排列,使用何种算法进行排序
希尔排序 具体思路是先拆分成若干个小的 然后再排


### hive的排序优化 
select * from(select name,Company from haha distribute by Company sort by Company)t order by Company
distribute by控制reduce如何处理数据，sort by 控制reduce的数据如何排序

Order by大哥力大无穷，可发挥全局排序大法，但是这逼在数据量很大的情况下，常常会跑不出来。
sort by二弟其力量是对reduce的单个输出进行排序的，木有全局排序的魔法。
distribute by小哥 可以按指定字段将数据划分到不同的reduce中 妹有排序的功能。


### 你们的ODS层设计了多少张表?最大的一张表有多少数据量
我们公司有业务表和行为表,我负责的是行为域,大概十多张吧,因为来源渠道不是很多,大致包括app端,网页端,小程序端什么的,最大的一张表是app用户行为数据表,每天的数据条数会有千万,旺季会达到亿级别


### 项目建设层设计到的数据调研和探索的内容大概有什么
和业务需求人员对接,数据保留的时间,数据重要的字段,统一口径字段等等

### ODS到DWD层的字典码内容转换你们是怎么做的?
建立一张维表统一字段,使用的时候做关联

### 一般ODS层到DWD层,任务报错了怎么处理
1. 先去查看hive和spark的web页面或者日志查看报错原因,然后定位解决
2. 如果不是hive和spark的问题,那就是脚本问题

### 数组源里面的脏数据你们是怎么处理的
我们对于核心字段缺失的就直接过滤掉了,然后只是游客登录的空账户信息,我们会做一个全局的Guid去处理这个(然后blabla说怎么处理的guid)

### 宽表的设计原则,或者说你们是怎么设计宽表的
我们开发宽表就是为了避免重复迭代,得需要了解一下业务全流程,知道需要扩展哪些维度,

### 有没有遇到过什么业务场景RDD比sql好用的
1. 在那种数据源为非结构化数据的时候,我们对数据进行预处理,什么session切割啊,脏数据剔除,字段信息补全,空值填充的时候,sql干不了,RDD就派出用场了
2. 做归因分析的时候我们也会用到RDD,因为一个用户有可能触发多次目标事件,然后我们在建模的时候就会需要去切分多段来给他打分


### UDF的使用 
我们在做地理位置回补创建字典表的时候,将经纬度退化成geohash值就用到了UDF


### Hive数据倾斜或者跑得慢怎么定位的然后排查和解决
1. 跑得慢的情况下,对于我来说我就会首先去看UI界面去查看是哪部分任务跑得慢,然后去看是否是资源分配不足,如果不是再去看对应的任务sql,排查是不是空值倾斜或者字段倾斜的问题,又或者是能不能开启mapjoin来解决shuffer问题
2. 但我知道的主要的解决方法其实是查看hive执行计划,然后找到具体的stage,根据提示信息得到相应的问题然后去更好的解决,但自己还没总结得够,需要去百度或者问别人来帮忙查看解决,自己还在学.


### 你们项目为什么要引进数仓



### 缓慢变化维有几种 
1. 第一种方式是直接覆盖原值
2. 第二种方式是用代理键去区分历史数据和新增数据
3. 第三种方式是添加新的字段去区别历史和新增

### 事实表有几种 
1. 事务事实表,也就是描述业务过程的事实表,保留着最原子的数据
2. 周期快照事实表,只看某个业务过程,按确定的时间去切分,比如每个月该用户的消费情况
3. 累积快照事实表,也就是一条业务的整个生命周期数据,比如这个人什么时候浏览什么时候点击什么时候下单


### 什么是事实表,什么是维度表,无事实表
事实表是围绕业务过程设计的一个可以被记录的表
维度表是可以以一个合适的角度去聚合主题的表
按我的理解,没有度量的表就是无事实表


### 你们是如何保证数据质量的
具体的我不是太知道,只知道他们有在开发质量检测管理系统,做了一些规则管理,sql模板管理,质量度量的可视化等东西

###为什么要用flink
1. 因为现在spark社区都开始在转向那个数据分析,算法方向上面了,所以我们自己认为了sparkStreaming在未来两到三年就会被淘汰.


### 项目文档 技术文档用什么维护的
jira 飞书

### 你们事实表包含哪些维度和度量 
维度：地域商圈 客群分类 房源描述 住客点评
度量  
Occ客房入住率 
ADR已售客房平均房价 
RevPAR 可供出租客房的收入 
Revenue月收入
CTP 营业利润贡献
GSS 宾客满意程度指数
MPI 市场渗透指数 


### 事实表和维度表应该怎么去设计
事实表的设计是以能够正确记录历史信息为准则，用来存储某个主题的主干内容,比如用户创建事件,用户选择点击下单,勾选喜好等行为都属于事实表

维度表的设计是以能够以合适的角度来聚合主题内容为准则,是事实表的补充,比如用户人附近的商圈,什么季度,离最近的节假日等等


### 你们数仓团队如何分工的
产品经理  离线数仓有几个人
BI又是谁负责 运维全链路的监控又是谁


### 数仓为什么要分层
我把数仓比作一个很大的图书馆，当书本达到海量的时候，你会发现当你想要一个找到一本书的时候，查询会非常吃力，扫描全部几TB的数据，所以我们可以用空间换时间：通过建设多层次的数据模型供用户使用，避免用户直接使用操作原始数据，可以更高效的访问数据。同时可以将复杂的问题分解成单个简单的步奏来完成，比较简单和容易理解。

划清层次结构：每一个数据分层都有它的作用域，这样我们在使用表的时候能更方便地定位和理解。
数据血缘追踪：简单来讲可以这样理解，我们最终给下游是直接能使用的业务表，但是它的来源有很多，如果有一张来源表出问题了，我们希望能够快速准确地定位到问题，并清楚它的危害范围。
减少重复开发：规范数据分层，开发一些通用的中间层数据，能够减少极大的重复计算。
把复杂问题简单化。将一个复杂的任务分解成多个步骤来完成，每一层只处理单一的步骤，比较简单和容易理解。而且便于维护数据的准确性，当数据出现问题之后，可以不用修复所有的数据，只需要从有问题的步骤开始修复。
屏蔽原始数据的异常。屏蔽业务的影响，不必改一次业务就需要重新接入数据。



### 星型模型 星座模型 雪花模型的区别 
星型模型:多为表的数据关系,是由一个事实表去关联多个维表组成,适合大数据的处理,缺点就是会由一定程度的数据冗余,因为会有重复的存储信息

雪花模型:多个维表没有直接连接到事实表上,而是通过其他维表去连接,就会造成一些层次现象,缺点就是会导致查询效率低下,因为会有多Join,不利于开发

星座模型:多张事实表共享维表信息,业务复杂,不经常用

### 上述三个模型的读写效率和存储空间有什么区别
1. 星座模型的读写效率较快,但是存储空间大,雪花模型较慢,但是存储空间小
2. 星座模型适合复杂的业务逻辑,不考虑读写效率和存储空间,能用就好.




### 说说你最擅长的业务模板 



### 你们哪个逻辑会遇到数据倾斜


### 用户画像中的标签个数 分为哪几类


### 标签是怎么加工的 


### 最复杂的标签是什么


### 实体建模和维度建模的区别 


### UDF UDAF UDTF继承的类怎么写


### Spark空跑的现象